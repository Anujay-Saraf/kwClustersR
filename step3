#Consider you have a dataset named "keyword_list.xlsx", with a column named "Keyword" with all your keywords in it.

#Install and load needed R packages
list.of.packages <- c("readxl", "stringdist")
new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[,"Package"])]
if(length(new.packages)) install.packages(new.packages)

library(readxl)
library(stringdist)

#Open your keyword_list.xlsx dataset
pathxlsx <- '/Users/remi/Downloads/keyword_list.xlsx'

df <-  read_excel(pathxlsx, 
                  sheet = 1, 
                  col_names = TRUE,   
                  na = "",                     
                  skip=0)


#Define the number of cluster you want to create
kclusters = round(0.90 * length(unique(df$Keyword)))

#Compute distance metrics between strings
uniqueThema <- unique(as.character(df$Keyword))
distancemodels <- stringdistmatrix(uniqueThema,uniqueThema,method = "jw")

#Display your clusters dendrogram
rownames(distancemodels) <- uniqueThema
hc <- hclust(as.dist(distancemodels))
par(mar = rep(2, 4)) #Cette ligne permet d'Ã©viter l'erreur "figure margins too large"
plot(hc)

#Create your cluster file and display a graph with the number of keywords in each cluster
dfClust <- data.frame(uniqueThema, cutree(hc, k=kclusters))
names(dfClust) <- c('Thema','cluster')
plot(table(dfClust$cluster))

View(dfClust)
